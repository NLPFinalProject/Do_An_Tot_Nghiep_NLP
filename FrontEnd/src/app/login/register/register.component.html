<h4 class="text-center">
  <b> {{ 'Register' | translate }} </b>
</h4>
<form nz-form [formGroup]="registerForm" (ngSubmit)="submitForm()">
  <section>
    <nz-form-item>
      <nz-form-control [nzOffset]="6" [nzSm]="14" [nzXs]="24">
        <div nz-row [nzGutter]="8">
          <div nz-col [nzSpan]="24">
            <input
              nz-input
              [placeholder]="'EmailOrganization (not required)' | translate"
              formControlName="emailOrganization"
              id="emailOrganization"
            />
          </div>
        </div>
      </nz-form-control>
    </nz-form-item>
  </section>
  <hr />
  <section>
    <nz-form-item>
      <nz-form-control [nzOffset]="6" [nzSm]="14" [nzXs]="24">
        <input nz-input [placeholder]="'Email' | translate" formControlName="email" id="email" />
        <div ngxErrors="email">
          <div *ngFor="let error of errors" [ngxError]="error.name" [when]="error.rules">
            <nz-form-explain translate class="errors">
              {{ 'Email is required' | translate }}
            </nz-form-explain>
          </div>
        </div>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item>
      <nz-form-control [nzOffset]="6" [nzSm]="14" [nzXs]="24">
        <div nz-row [nzGutter]="8">
          <div nz-col [nzSpan]="24">
            <input
              nz-input
              type="text"
              [placeholder]="'FullName' | translate"
              id="fullName"
              formControlName="fullName"
            />
            <div *ngIf="registerForm.get('fullName')?.errors && registerForm.get('fullName').touched">
              <ng-container [ngSwitch]="true">
                <div *ngSwitchCase="registerForm.get('fullName').hasError('required')">Fullname is required</div>
                <div *ngSwitchCase="registerForm.get('fullName').hasError('maxlength')">
                  Full name can not be more than 30 characters
                </div>
                <div *ngSwitchCase="registerForm.get('fullName').hasError('confirm')">
                  Fullname must not contain special character
                </div>
              </ng-container>
            </div>
          </div>
        </div>
      </nz-form-control>
    </nz-form-item>
    <nz-form-item>
      <nz-form-control [nzOffset]="6" [nzSm]="14" [nzXs]="24">
        <div nz-row [nzGutter]="8">
          <div nz-col [nzSpan]="12">
            <nz-date-picker formControlName="ngaySinh" [nzFormat]="dateFormat"></nz-date-picker>
          </div>

          <div nz-col [nzSpan]="12">
            <label nz-checkbox formControlName="gioiTinh">
              <span> {{ 'Gender' | translate }}</span>
            </label>
          </div>
        </div>
        <div *ngIf="registerForm.get('ngaySinh')?.hasError('confirm') && registerForm.get('ngaySinh').dirty">
          <div>Your birthday can not be later than today</div>
        </div>
      </nz-form-control>
    </nz-form-item>

    <nz-form-item>
      <nz-form-control [nzOffset]="6" [nzSm]="14" [nzXs]="24" [nzValidateStatus]="registerForm.controls['phoneNumber']">
        <nz-input-group [nzAddOnBefore]="addOnBeforeTemplate">
          <ng-template #addOnBeforeTemplate>
            <nz-select formControlName="phoneNumberPrefix" style="width: 70px">
              <nz-option nzLabel="+84" nzValue="+84"></nz-option>
            </nz-select>
          </ng-template>
          <input formControlName="phoneNumber" [placeholder]="'Phone' | translate" id="'phoneNumber'" nz-input />
        </nz-input-group>
        <div *ngIf="registerForm.get('phoneNumber')?.errors && registerForm.get('phoneNumber').touched">
          <ng-container [ngSwitch]="true">
            <div *ngSwitchCase="registerForm.get('phoneNumber').hasError('required')">Phone is required]</div>
            <div
              *ngSwitchCase="
                registerForm.get('phoneNumber').hasError('minlength') ||
                registerForm.get('phoneNumber').hasError('maxlength')
              "
            >
              phonelength must be between 9 and 12
            </div>
            <div *ngSwitchCase="registerForm.get('phoneNumber').hasError('pattern')">Phone contains only number</div>
          </ng-container>
        </div>
      </nz-form-control>
    </nz-form-item>
  </section>
  <hr />
  <section>
    <nz-form-item>
      <nz-form-control [nzOffset]="6" [nzSm]="14" [nzXs]="24">
        <div nz-row [nzGutter]="8">
          <div nz-col [nzSpan]="12">
            <nz-input-group [nzSuffix]="suffixTemplate">
              <input
                nz-input
                [type]="passwordVisible ? 'text' : 'password'"
                id="password"
                [placeholder]="'Password' | translate"
                formControlName="password"
                (ngModelChange)="updateConfirmValidator()"
              />
            </nz-input-group>
            <ng-template #suffixTemplate>
              <i
                nz-icon
                [nzType]="passwordVisible ? 'eye-invisible' : 'eye'"
                (click)="passwordVisible = !passwordVisible"
              ></i>
            </ng-template>
            <div ngxErrors="password">
              <div *ngFor="let error of errors" [ngxError]="error.name" [when]="error.rules">
                <nz-form-explain translate class="errors">
                  {{ 'Password is required' | translate }}
                </nz-form-explain>
              </div>
            </div>
          </div>
          <div nz-col [nzSpan]="12">
            <nz-input-group [nzSuffix]="templateCheckPass">
              <input
                nz-input
                [type]="checkPasswordVisible ? 'text' : 'password'"
                [placeholder]="'Confirm' | translate"
                formControlName="checkPassword"
                id="checkPassword"
              />
            </nz-input-group>
            <ng-template #templateCheckPass>
              <i
                nz-icon
                [nzType]="checkPasswordVisible ? 'eye-invisible' : 'eye'"
                (click)="checkPasswordVisible = !checkPasswordVisible"
              ></i>
            </ng-template>

            <nz-form-explain
              *ngIf="registerForm.get('checkPassword')?.dirty && registerForm.get('checkPassword')?.errors"
            >
              <ng-container *ngIf="registerForm.get('checkPassword')?.hasError('required')">
                {{ 'Please confirm your password!' | translate }}
              </ng-container>
              <ng-container *ngIf="registerForm.get('checkPassword')?.hasError('confirm')">
                {{ 'Two passwords that you enter is inconsistent!' | translate }}
              </ng-container>
            </nz-form-explain>
          </div>
        </div>
      </nz-form-control>
    </nz-form-item>
  </section>

  <nz-form-item nz-row style="margin-bottom: 8px">
    <nz-form-control [nzSpan]="14" [nzOffset]="6">
      <label nz-checkbox formControlName="agree">
        <span>I have read the <a>agreement</a></span>
      </label>
    </nz-form-control>
  </nz-form-item>

  <nz-form-item nz-row style="text-align: center">
    <nz-form-control [nzSpan]="14" [nzOffset]="6">
      <button [routerLink]="['/login']" routerLinkActive="router-link-active" nz-button nzType="default" translate>
        {{ 'Back' | translate }}
      </button>
      <button class="margin-left-6" [disabled]="registerForm.invalid" nz-button nzType="primary" translate>
        {{ 'Register' | translate }}
      </button>
    </nz-form-control>
  </nz-form-item>
</form>
